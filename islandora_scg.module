<?php

/**
 * @file
 * Placeholder module file for Islandora Sample Content Generator.
 */

/**
 * Implements hook_theme().
 */
function islandora_scg_theme() {
  return array(
    'islandora_scg_metadata_ds' => array(
      'variables' => array(
        'metadata' => NULL,
      ),
      'template' => 'theme/islandora_scg_metadata_ds',
    ),
  );
}

/**
 * Implements hook_preprocess_theme().
 */
function islandora_scg_preprocess_islandora_scg_metadata_ds(array &$variables) {
  // Read the sample metadata file and grab a random row.
  $sample_metadata = &drupal_static(__FUNCTION__);
  if (!isset($sample_metadata)) {
    $path = drupal_get_path('module', 'islandora_scg') . DIRECTORY_SEPARATOR .
      'includes' . DIRECTORY_SEPARATOR . 'sample_metadata.tsv.inc';
    $sample_metadata = file($path);
  }

  $random_line_number = array_rand($sample_metadata);
  $metadata = explode("\t", $sample_metadata[$random_line_number]);

  $variables['title'] = htmlspecialchars($metadata[0]);
  $variables['dateIssued'] = htmlspecialchars($metadata[1]);
  $variables['abstract'] = htmlspecialchars(trim($metadata[2]));
}

